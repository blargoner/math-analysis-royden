% Notes and exercises from Real Analysis by Royden
% By John Peloquin
\documentclass[letterpaper,12pt]{article}
\usepackage{amsmath,amssymb,amsthm,enumitem,fourier}

\newcommand{\C}{\mathcal{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Rex}{\overline{\R}}
\newcommand{\Gd}{G_{\delta}}
\newcommand{\Fs}{F_{\sigma}}

\newcommand{\union}{\cup}
\newcommand{\sect}{\cap}
\newcommand{\diff}{\bigtriangleup}
\newcommand{\bigunion}{\bigcup}
\newcommand{\bigsect}{\bigcap}
\newcommand{\after}{\circ}

\newcommand{\len}{l}
\newcommand{\mo}{m^*}
\newcommand{\m}{m}

\newcommand{\comp}[1]{\widetilde{#1}}
\newcommand{\closure}[1]{\overline{#1}}
\newcommand{\res}[2]{{#1}|_{#2}}
\newcommand{\abs}[1]{|{#1}|}
\newcommand{\bigabs}[1]{\left|{#1}\right|}
\newcommand{\chr}[1]{\chi_{#1}}
\newcommand{\inv}[1]{#1^{-1}}

% Theorems
\theoremstyle{plain}
\newtheorem*{lem}{Lemma}
\newtheorem*{prop}{Proposition}

\theoremstyle{definition}
\newtheorem*{exer}{Exercise}

\theoremstyle{remark}
\newtheorem*{rmk}{Remark}

% Meta
\title{Notes and exercises from \textit{Real Analysis}}
\author{John Peloquin}
\date{}

\begin{document}
\maketitle

\section*{Introduction}
This document contains notes and exercises from~\cite{royden}.

\section*{Chapter~3}
\subsection*{Section~2}
\begin{prop}[5]
Given any \(A\subseteq\R\) and any \(\epsilon>0\), there is an open set~\(O\) such that \(A\subseteq O\) and \(\mo O\le\mo A+\epsilon\). There is a \(G\in\Gd\) such that \(A\subseteq G\) and \(\mo A=\mo G\).
\end{prop}
\begin{proof}
If \(\mo A=\infty\), take \(O=G=\R\). If \(\mo A<\infty\), there is a countable set~\(\{I_n\}\) of open intervals with \(A\subseteq\bigunion I_n\) and \(\sum\len(I_n)<\mo A+\epsilon\). Let \(O=\bigunion I_n\). Then \(O\)~is open (Proposition~2.7), \(A\subseteq O\), and
\[\mo O\le\sum\mo I_n=\sum\len(I_n)<\mo A+\epsilon\]
by countable subadditivity (Proposition~2) and the outer measure of intervals (Proposition~1).

For each~\(n\ge 1\), let \(O_n\)~be open with \(A\subseteq O_n\) and \(\mo O_n\le\mo A+1/n\). Let \(G=\bigsect O_n\). Then \(G\in\Gd\) and \(A\subseteq G\). By monotonicity, \(\mo A\le\mo G\) and
\[\mo G\le\mo O_n\le\mo A+1/n\]
for all \(n\ge 1\), so \(\mo A=\mo G\).
\end{proof}

\begin{exer}[5]
Let \(A=\Q\sect(0,1)\), and let \(\{I_n\}\)~be a finite set of open intervals with \(A\subseteq\bigunion I_n\). Then \(\sum\len(I_n)\ge 1\).
\end{exer}
\begin{proof}
By density of~\(\Q\) in~\(\R\) (Corollary~2.4), \([0,1]=\closure{A}\subseteq\closure{\bigunion I_n}=\bigunion\closure{I_n}\), so
\[1=\len[0,1]=\mo[0,1]\le\mo\bigunion\closure{I_n}\le\sum\mo\closure{I_n}=\sum\len(I_n)\qedhere\]
\end{proof}

\begin{exer}[7]
If \(E\subseteq\R\) and \(y\in\R\), then \(\mo(E+y)=\mo E\).
\end{exer}
\begin{proof}
First, if \(E=(a,b)\) with \(-\infty\le a<b\le\infty\), then \(E+y=(a+y,b+y)\), so
\[\len(E+y)=b-a=\len(E)\]
Now if \(E\)~is arbitrary and \(\{I_n\}\)~is a countable set of open intervals with \(E\subseteq\bigunion I_n\), then \(\{I_n+y\}\)~is a countable set of open intervals with \(E+y\subseteq\bigunion(I_n+y)\) and \(\sum\len(I_n+y)=\sum\len(I_n)\) by the above. Therefore \(\mo(E+y)\le\mo E\). Conversely,
\[\mo E=\mo((E+y)-y)\le\mo(E+y)\]
so \(\mo(E+y)=\mo E\).
\end{proof}

\begin{exer}[8]
If \(\mo A=0\), then \(\mo(A\union B)=\mo B\).
\end{exer}
\begin{proof}
We have \(\mo B\le\mo(A\union B)\le\mo A+\mo B=\mo B\).
\end{proof}

\subsection*{Section~3}
We provide an alternative proof of Lemma~7.
\begin{lem}[7]
If \(E_1,E_2\subseteq\R\) are measurable, so is~\(E_1\union E_2\).
\end{lem}
\begin{proof}
Let \(A\subseteq\R\). We first claim\footnote{This is an inclusion-exclusion inequality for outer measure.}
\[\mo(A\sect[E_1\union E_2])+\mo(A\sect E_1\sect E_2)\le\mo(A\sect E_1)+\mo(A\sect E_2)\tag{1}\]
Indeed, since \(A\sect(E_1\union E_2)=(A\sect E_1\sect E_2)\union(A\sect E_1\sect\comp{E_2})\union(A\sect\comp{E_1}\sect E_2)\),
\[\mo(A\sect[E_1\union E_2])\le\mo(A\sect E_1\sect E_2)+\mo(A\sect E_1\sect\comp{E_2})+\mo(A\sect\comp{E_1}\sect E_2)\]
by subadditivity, so
\begin{align*}
\mo(A\sect[E_1\union E_2])+\mo(A\sect E_1\sect E_2)&\le\mo([A\sect E_1]\sect E_2)+\mo([A\sect E_1]\sect\comp{E_2})\\
	&\ +\mo([A\sect E_2]\sect E_1)+\mo([A\sect E_2]\sect\comp{E_1})\\
	&=\mo(A\sect E_1)+\mo(A\sect E_2)
\end{align*}
by measurability of \(E_1\)~and~\(E_2\), establishing~(1).

We now claim \(\mo(A\sect[E_1\union E_2])+\mo(A\sect[\comp{E_1\union E_2}])\le\mo A\). If \(\mo A=\infty\), there is nothing to prove, so we assume \(\mo A<\infty\). We have
\begin{align*}
\mo(A\sect[E_1\union E_2])+\mo(A\sect\comp{E_1}\sect\comp{E_2})+\mo A&\le\mo(A\sect[E_1\union E_2])+\mo(A\sect E_1\sect E_2)\\
	&\ +\mo(A\sect[\comp{E_1}\union\comp{E_2}])+\mo(A\sect\comp{E_1}\sect\comp{E_2})\\
	&\le\mo(A\sect E_1)+\mo(A\sect E_2)\\
	&\ +\mo(A\sect\comp{E_1})+\mo(A\sect\comp{E_2})\\
	&=\mo A+\mo A
\end{align*}
where the first inequality follows from \(A=(A\sect E_1\sect E_2)\union(A\sect[\comp{E_1}\union\comp{E_2}])\) and subadditivity, the second inequality follows from~(1), and the equality follows from measurability of \(E_1\)~and~\(E_2\). The claim now follows since \(\mo A<\infty\). Since \(A\)~was arbitrary, \(E_1\union E_2\)~is measurable.
\end{proof}

\begin{prop}[15]
Let \(E\subseteq\R\). The following are equivalent:
\begin{enumerate}
\item[(i)] \(E\)~is measurable.
\item[(ii)] Given \(\epsilon>0\), there is an open set \(O\supseteq E\) with \(\mo(O-E)<\epsilon\).
\item[(iii)] Given \(\epsilon>0\), there is a closed set \(F\subseteq E\) with \(\mo(E-F)<\epsilon\).
\item[(iv)] There is \(G\in\Gd\) with \(E\subseteq G\) and \(\mo(G-E)=0\).
\item[(v)] There is \(F\in\Fs\) with \(F\subseteq E\) and \(\mo(E-F)=0\).
\end{enumerate}
If \(\mo E<\infty\), these are all equivalent to:
\begin{enumerate}
\item[(vi)] Given \(\epsilon>0\), there is a finite union~\(U\) of open intervals with\footnote{Recall \(U\diff E=(U-E)\union(E-U)\) is the symmetric difference of \(U\)~and~\(E\).} \(\mo(U\diff E)<\epsilon\).
\end{enumerate}
\end{prop}
\begin{proof}
(i)\(\implies\)(ii): Let \(\epsilon>0\). There is an open set \(O\supseteq E\) with \(\mo O\le\mo E+\epsilon/2\) (Proposition~5). Now \(O=E\union(O-E)\), so by measurability (Theorems 10,12) and additivity (Proposition~13),
\[\mo E+\mo(O-E)=\mo O\le\mo E+\epsilon/2\]
If \(\mo E<\infty\), it follows that \(\mo(O-E)\le\epsilon/2<\epsilon\). If \(\mo E=\infty\), let \(E_n=E\sect[-n,n]\). Then \(E_n\)~is measurable and \(\mo E_n<\infty\), so we may choose an open set \(O_n\supseteq E_n\) with \(\mo(O_n-E_n)<\epsilon/2^{n+1}\) by the above. Let \(O=\bigunion O_n\). Then \(O\)~is open, \(E\subseteq O\), and
\[O-E=\bigunion O_n-E=\bigunion(O_n-E)\subseteq\bigunion(O_n-E_n)\]
so
\[\mo(O-E)\le\sum\mo(O_n-E_n)\le\sum\epsilon/2^{n+1}=\epsilon/2<\epsilon\]

(i)\(\implies\)(iii): Let \(\epsilon>0\). Since \(\comp{E}\)~is measurable, there is an open set \(O\supseteq\comp{E}\) with \(\mo(O-\comp{E})<\epsilon\) by the above. Let \(F=\comp{O}\). Then \(F\)~is closed, \(F\subseteq E\), and \(E-F=O-\comp{E}\), so \(\mo(E-F)=\mo(O-\comp{E})<\epsilon\).

(ii)\(\implies\)(iv): For each \(n\ge1\), choose \(O_n\supseteq E\) open with \(\mo(O_n-E)<1/n\). Let \(G=\bigsect O_n\). Then \(G\in\Gd\), \(E\subseteq G\), and \(G-E\subseteq O_n-E\) for all~\(n\), so \(\mo(G-E)\le\mo(O_n-E)<1/n\) for all~\(n\), so \(\mo(G-E)=0\).

(iii)\(\implies\)(v): For each \(n\ge1\), choose \(F_n\subseteq E\) closed with \(\mo(E-F_n)<1/n\). Let \(F=\bigunion F_n\). Then \(F\in\Fs\), \(F\subseteq E\), and \(E-F\subseteq E-F_n\) for all~\(n\), so \(\mo(E-F)\le\mo(E-F_n)<1/n\) for all~\(n\), so \(\mo(E-F)=0\).

(iv)\(\implies\)(i): If \(G\in\Gd\), \(E\subseteq G\), and \(\mo(G-E)=0\), then \(G\)~is measurable and \(G-E\)~is measurable, so \(E=G-(G-E)\) is also measurable.

(v)\(\implies\)(i): If \(F\in\Fs\), \(F\subseteq E\), and \(\mo(E-F)=0\), then \(F\)~is measurable and \(E-F\)~is measurable, so \(E=F\union(E-F)\) is also measurable.

The implications above establish the equivalence of (i)--(v). Finally, suppose \(\mo E<\infty\).

(ii)\(\implies\)(vi): Let \(\epsilon>0\). Choose \(O\supseteq E\) open with \(\mo(O-E)<\epsilon/2\). Write \(O=\bigunion I_n\), where \(\{I_n\}\)~is a countable set of disjoint open intervals (Proposition~2.8). By additivity,
\[\sum\mo I_n=\mo(O)<\mo(E)+\epsilon/2<\infty\]
so there is~\(N\) with \(\mo O-\sum_{n=1}^N\mo I_n<\epsilon/2\). Let \(U=\bigunion_{n=1}^N I_n\). Then \(U-E\subseteq O-E\), so \(\mo(U-E)\le\mo(O-E)<\epsilon/2\), and \(E-U\subseteq O-U\), so \(\mo(E-U)\le\mo(O-U)=\mo O-\mo U<\epsilon/2\). Therefore
\[\mo(U\diff E)\le\mo(U-E)+\mo(E-U)<\epsilon/2+\epsilon/2=\epsilon\]

(vi)\(\implies\)(ii): Let \(\epsilon>0\). Choose a finite union~\(U\) of open intervals with \(\mo(U\diff E)<\epsilon/3\). Choose \(V\supseteq E-U\) open with \(\mo V\le\mo(E-U)+\epsilon/3\) (Proposition~5). Let \(O=U\union V\). Then \(O\)~is open, \(E\subseteq O\), and \(O-E\subseteq(U-E)\union V\), so
\begin{align*}
\mo(O-E)&\le\mo(U-E)+\mo V\\
	&\le\mo(U-E)+\mo(E-U)+\epsilon/3\\
	&<\epsilon/3+\epsilon/3+\epsilon/3=\epsilon\qedhere
\end{align*}
\end{proof}

\begin{exer}[9]
If \(E\subseteq\R\) is measurable, then \(E+y\)~is measurable.
\end{exer}
\begin{proof}
Let \(A\subseteq\R\). Then\footnote{We write \(A\sect B+y\) for \((A\sect B)+y\).}
\begin{align*}
A\sect(E+y)&=(A-y)\sect E+y\\
A\sect(\comp{E+y})&=(A-y)\sect\comp{E}+y
\end{align*}
For example, if \(z\in A\sect(E+y)\), then \(z\in A\) and \(z=x+y\) with \(x\in E\), hence \(z-y=x\in(A-y)\sect E\), and \(z=(z-y)+y\in(A-y)\sect E+y\). Now
\begin{align*}
\mo(A\sect[E+y])+\mo(A\sect[\comp{E+y}])&=\mo([A-y]\sect E+y)+\mo([A-y]\sect\comp{E}+y)\\
	&=\mo([A-y]\sect E)+\mo([A-y]\sect\comp{E})\\
	&=\mo(A-y)\\
	&=\mo A
\end{align*}
where the second and fourth equalities follow from translation invariance of outer measure (Exercise~7) and the third equality follows from measurability of~\(E\). Therefore \(E+y\)~is measurable.
\end{proof}

\begin{exer}[10]
If \(E_1,E_2\subseteq\R\) are measurable, then
\[\mo(E_1\union E_2)+\mo(E_1\sect E_2)=\mo E_1+\mo E_2\]
\end{exer}
\begin{proof}
By the same argument used in the proof of Lemma~7 above (with \(A=\R\)), except appealing to additivity instead of subadditivity to get equality.
\end{proof}

\begin{exer}[11]
For each \(n\ge 1\), let \(E_n=(n,\infty)\). Then \(E_{n+1}\subseteq E_n\) and \(\bigsect E_n=\emptyset\), but \(E_n\)~is measurable with \(\mo E_n=\infty\), so
\[\mo\bigsect E_n=0\ne\infty=\lim_{n\to\infty}\mo E_n\]
\end{exer}

\begin{exer}[12]
If \(\{E_n\}\)~is a countable sequence of disjoint measurable sets and \(A\subseteq\R\), then
\[\mo\left(A\sect\bigunion E_n\right)=\sum\mo(A\sect E_n)\]
\end{exer}
\begin{proof}
We have \(A\sect\bigunion E_n=\bigunion(A\sect E_n)\). Let \(F_n=A\sect E_n\). Then \(\mo\bigunion F_n\le\sum\mo F_n\) by subadditivity. Conversely, for any \(N\ge 1\),
\[\sum_{n=1}^N\mo F_n=\mo\bigunion_{n=1}^N F_n\le\mo\bigunion F_n\]
by finite additivity (Lemma~9) and monotonicity. Letting \(N\to\infty\), we have \(\sum\mo F_n\le\mo\bigunion F_n\) and hence \(\sum\mo F_n=\mo\bigunion F_n\).
\end{proof}

\begin{exer}[14]
The Cantor ternary set~\(C\) has measure zero.
\end{exer}
\begin{proof}
Write \(C=\bigsect C_n\) where \(C_n\)~is a union of~\(2^n\) disjoint closed intervals each of length~\(3^{-n}\) and \(C_{n+1}\subseteq C_n\). Then \(C_n\)~is measurable with \(\mo C_n=(2/3)^n\) and \(C\)~is measurable with \(\mo C=\lim_{n\to\infty}(2/3)^n=0\) (Proposition~14).
\end{proof}

\subsection*{Section~5}
\begin{rmk}
We write \(\{\,f>\alpha\,\}\) for \(\{\,x\mid f(x)>\alpha\,\}\), \(\{\,f=\alpha\,\}\) for \(\{\,x\mid f(x)=\alpha\,\}\), and similarly for other sets.
\end{rmk}

\begin{rmk}
A constant function (with measurable domain) is measurable.
\end{rmk}

\begin{rmk}
A continuous function~\(f\) (with measurable domain) is measurable. If \(\alpha\in\R\), then \((\alpha,\infty]\)~is open, so \(\{\,f>\alpha\,\}=f^{-1}(\alpha,\infty]\) is open and measurable.
\end{rmk}

\begin{rmk}
A step function\footnote{Recall that a step function is just a finite linear combination of characteristic functions of intervals.} \(f\) is measurable. If \(\alpha\in\R\), then \(\{\,f>\alpha\,\}\) is a finite union of intervals and hence measurable.
\end{rmk}

\begin{rmk}
The restriction of a measurable function~\(f\) to a measurable subset~\(E\) of its domain is measurable. If \(\alpha\in\R\), \(\{\,\res{f}{E}>\alpha\,\}=\{\,f>\alpha\,\}\sect E\) is measurable.
\end{rmk}

\begin{exer}[19]
If \(D\subseteq\R\) is dense and \(f:\R\to\Rex\) is such that \(\{\,f>\alpha\,\}\) is measurable for each \(\alpha\in D\), then \(f\)~is measurable.
\end{exer}
\begin{proof}
If \(\alpha\in\R\), choose \(\{\alpha_k\}\subseteq D\) with \(\alpha_k>\alpha\) and \(\alpha_k\to\alpha\) by density of~\(D\). Then
\[\{\,f>\alpha\,\}=\bigunion_{k=1}^{\infty}\{\,f>\alpha_k\,\}\]
is measurable.
\end{proof}

\begin{exer}[21]\ 
\begin{enumerate}
\item[(a)] If \(D,E\subseteq\R\) are measurable and \(f:D\union E\to\Rex\), then \(f\)~is measurable if and only if \(\res{f}{D}\)~and~\(\res{f}{E}\) are measurable.
\item[(b)] If \(D\subseteq\R\) is measurable and \(f:D\to\Rex\), then \(f\)~is measurable if and only if
\[g(x)=\begin{cases}
f(x)&\text{if }x\in D\\
0&\text{otherwise}
\end{cases}\]
is measurable.
\end{enumerate}
\end{exer}
\begin{proof}\ 
\begin{enumerate}
\item[(a)] The forward direction follows from the remark above about restrictions. If \(\res{f}{D}\)~and~\(\res{f}{E}\) are measurable, then \(D\union E\)~is measurable and
\[\{\,f>\alpha\,\}=\{\,\res{f}{D}>\alpha\,\}\union\{\,\res{f}{E}>\alpha\,\}\]
is measurable for all \(\alpha\in\R\), so \(f\)~is measurable.
\item[(b)] By part~(a), \(g\)~is measurable if and only if the restrictions \(\res{g}{D}=f\) and \(\res{g}{\comp{D}}=0\) are measurable, which is true if and only if \(f\)~is measurable.\qedhere
\end{enumerate}
\end{proof}

\begin{exer}[22]\ 
\begin{enumerate}
\item[(a)] Let \(D\subseteq\R\) be measurable and \(f:D\to\Rex\). Let \(D_1=\{\,f=\infty\,\}\) and \(D_2=\{\,f=-\infty\,\}\). Then \(f\)~is measurable if and only if \(D_1\)~and~\(D_2\) are measurable and \(\res{f}{D-(D_1\union D_2)}\)~is measurable.
\item[(b)] If \(f,g:D\to\Rex\) are measurable, then \(fg\)~is measurable.
\item[(c)] If \(f,g:D\to\Rex\) are measurable and \(\alpha\in\Rex\), then \(f+g\)~is measurable if it is defined to be~\(\alpha\) when it is of form \(\infty-\infty\) or \(-\infty+\infty\).
\item[(d)] If \(f,g:D\to\Rex\) are measurable and finite~a.e., then \(f+g\)~is measurable no matter how it is defined when it is of the form \(\infty-\infty\) or \(-\infty+\infty\).
\end{enumerate}
\end{exer}
\begin{proof}\ 
\begin{enumerate}
\item[(a)] If \(f\)~is measurable, then \(D_1\)~and~\(D_2\) are measurable (Proposition~18), so \(D-(D_1\union D_2)\) is measurable, and \(\res{f}{D-(D_1\union D_2)}\) is measurable by the remark above about restrictions.

For the converse, note \(D=[D-(D_1\union D_2)]\union D_1\union D_2\) and the restrictions \(\res{f}{D-(D_1\union D_2)}\), \(\res{f}{D_1}=\infty\), and \(\res{f}{D_2}=-\infty\) are measurable, so \(f\)~is measurable by Exercise~21(a).

\item[(b)] We have
\begin{align*}
\{\,fg=\infty\,\}&=\left(\,\{\,f=\infty\,\}\sect\{\,g>0\,\}\,\right)\\
	&\quad\union\left(\,\{\,f=-\infty\,\}\sect\{\,g<0\,\}\,\right)\\
	&\quad\union\left(\,\{\,f>0\,\}\sect\{\,g=\infty\,\}\,\right)\\
	&\quad\union\left(\,\{\,f<0\,\}\sect\{\,g=-\infty\,\}\,\right)
\end{align*}
which is measurable since \(f\)~and~\(g\) are measurable. Similarly \(\{\,fg=-\infty\,\}\) is measurable.

Let \(F=\{\,f\ne\pm\infty\,\}\sect\{\,g\ne\pm\infty\,\}\). Then
\[\{\,fg\ne\pm\infty\,\}=F\union\{\,f=0\,\}\union\{\,g=0\,\}\]
Now \(F\)~is measurable, so \(\res{f}{F}\)~and~\(\res{g}{F}\) are measurable, and \(\res{fg}{F}=\res{f}{F}\cdot\res{g}{F}\) is measurable (Proposition~19). Also \(\res{fg}{\{f=0\}}=0\) and \(\res{fg}{\{g=0\}}=0\) are measurable. Hence \(\res{fg}{\{fg\ne\pm\infty\}}\)~is measurable by Exercise~21(a).

It follows that \(fg\)~is measurable by part~(a).

\item[(c)] We assume \(\alpha\in\R\) (the cases \(\alpha=\pm\infty\) are similar). Then
\[\{\,f+g=\infty\,\}=\left(\,\{\,f=\infty\,\}\sect\{\,g\ne-\infty\,\}\,\right)\union\left(\,\{\,f\ne-\infty\,\}\sect\{\,g=\infty\,\}\,\right)\]
is measurable since \(f\)~and~\(g\) are measurable. Similarly \(\{\,f+g=-\infty\,\}\) is measurable.

Let \(F=\{\,f\ne\pm\infty\,\}\sect\{\,g\ne\pm\infty\,\}\), \(I_1=\{\,f=\infty\,\}\sect\{\,g=-\infty\,\}\), and \(I_2=\{\,f=-\infty\,\}\sect\{\,g=\infty\,\}\). Then \(\{\,f+g\ne\pm\infty\,\}=F\union I_1\union I_2\). Now \(F\)~is measurable, so \(\res{f}{F}\)~and~\(\res{g}{F}\) are measurable, and \(\res{(f+g)}{F}=\res{f}{F}+\res{g}{F}\) is measurable (Proposition~19). Also \(\res{f}{I_1\union I_2}=\alpha\) is measurable. Hence \(\res{(f+g)}{\{f+g\ne\pm\infty\}}\)~is measurable by Exercise~21(a).

It follows that \(f+g\)~is measurable by part~(a).

\item[(d)] By part~(c), \(f+g\)~is equal~a.e. to a measurable function (with \(\alpha=0\), say), hence is measurable (Proposition~21).\qedhere
\end{enumerate}
\end{proof}

\begin{exer}[23]\ 
\begin{enumerate}
\item[(a)] Let \(f:[a,b]\to\Rex\) be measurable and finite~a.e. Given \(\epsilon>0\), there exists~\(M\) with \(\abs{f}\le M\) except on a set of measure less than~\(\epsilon\).
\item[(b)] Let \(f:[a,b]\to\Rex\) be measurable. Given \(\epsilon>0\) and~\(M\), there exists a simple function \(\varphi:[a,b]\to\R\) with \(\abs{f-\varphi}<\epsilon\) except where \(\abs{f}\ge M\). If \(m\le f\le M\), then we may take \(m\le\varphi\le M\).
\item[(c)] Let \(\varphi:[a,b]\to\R\) be simple. Given \(\epsilon>0\), there exists a step function \(g:[a,b]\to\R\) with \(\varphi=g\) except on a set of measure less than~\(\epsilon\). If \(m\le\varphi\le M\), then we may take \(m\le g\le M\).
\item[(d)] Let \(g:[a,b]\to\R\) be a step function. Given \(\epsilon>0\), there exists a continuous function \(h:[a,b]\to\R\) with \(g=h\) except on a set of measure less than~\(\epsilon\). If \(m\le g\le M\), then we may take \(m\le h\le M\).
\end{enumerate}
Finally, if \(f:[a,b]\to\Rex\) is measurable and finite~a.e., then given \(\epsilon>0\) there exists a step function~\(g:[a,b]\to\R\) and a continuous function \(h:[a,b]\to\R\) such that
\[\abs{f-g}<\epsilon\qquad\text{and}\qquad\abs{f-h}<\epsilon\]
except on a set of measure less than~\(\epsilon\). Moreover, if \(m\le f\le M\), then we may take \(m\le g\le M\) and \(m\le h\le M\).
\end{exer}
\begin{proof}\ 
\begin{enumerate}
\item[(a)] Let \(\epsilon>0\). Since \(f\)~is measurable,
\[F_n=\{\,\abs{f}>n\,\}=\{\,f<-n\,\}\union\{\,f>n\,\}\]
is measurable for all~\(n\ge0\), with \(\m F_n<\infty\) since \(F_n\subseteq[a,b]\). Moreover, \(F_{n+1}\subseteq F_n\) and \(\bigsect F_n=\{\,\abs{f}=\infty\,\}\). Therefore (Proposition~14)
\[\lim\m F_n=\m\bigsect F_n=\m\{\,\abs{f}=\infty\,\}=0\]
since \(f\)~is finite~a.e. Choose~\(M\) with \(\m F_M<\epsilon\). Then \(\abs{f}\le M\) except on a set of measure less than~\(\epsilon\).

\item[(b)] Let \(\epsilon,M>0\). Let \(-M=\alpha_0<\cdots<\alpha_n=M\) be a partition of~\([-M,M]\) with mesh less than~\(\epsilon\). Let \(A_i=\{\,\alpha_{i-1}<f\le\alpha_i\,\}\) for \(1\le i\le n\). Then each~\(A_i\) is measurable since \(f\)~is measurable.

Let \(\varphi=\sum_{i=1}^n\alpha_i\chr{A_i}\). Then \(\varphi\)~is simple. If \(\abs{f(x)}<M\), then \(x\in A_i\) for exactly one \(1\le i\le n\), so \(\varphi(x)=\alpha_i\) and
\[\abs{f(x)-\varphi(x)}<\alpha_i-\alpha_{i-1}<\epsilon\]
Therefore \(\abs{f-\varphi}<\epsilon\) except where \(\abs{f}\ge M\). If \(m\le f\le M\), then by instead partitioning \([m,M]\) we obtain \(m\le\varphi\le M\).

\item[(c)] Let \(\epsilon>0\). Write \(\varphi=\sum_{i=1}^n\alpha_i\chr{A_i}\) where the sets~\(A_i\) are measurable and partition~\([a,b]\). For each~\(A_i\), there exists a finite union~\(U_i\) of open intervals with \(\m(A_i\diff U_i)<\epsilon/n\) (Proposition~15). Let \(D_i=A_i\diff U_i\).

Let \(g=\sum_{i=1}^n\alpha_i\chr{U_i}\) on~\([a,b]\). Then \(g\)~is a step function. If \(\varphi(x)\ne g(x)\), then \(x\in A_i\) for exactly one \(1\le i\le n\). If \(x\not\in U_i\), then \(x\in A_i-U_i\subseteq D_i\). If \(x\in U_i\), then we must also have \(x\in U_j\) for some \(j\ne i\), lest \(\varphi(x)=\alpha_i=g(x)\), so \(x\in U_j-A_j\subseteq D_j\). Hence \(\{\,\varphi\ne g\,\}\subseteq\bigunion D_i\), so \(\mo\{\,\varphi\ne g\,\}\le\sum\m D_i<n(\epsilon/n)=\epsilon\). Therefore \(\varphi=g\) except on a set of measure less than~\(\epsilon\).

If \(m\le\varphi\le M\), then by setting \(g(x)=m\) for \(x\not\in\bigunion U_i\) and for \(x\in U_i\sect U_j\) with \(i\ne j\), we have \(m\le g\le M\).

\item[(d)] Let \(\epsilon>0\). Write \(a=x_0<\cdots<x_n=b\) with partition mesh~\(\delta\) and \(g(x)=\alpha_i\) for \(x\in(x_{i-1},x_i)\), \(1\le i\le n\). Let \(\gamma=\min(\epsilon/n,\delta)/2\). Define \(h\)~to be equal to~\(g\) except for \(1\le i\le n-1\) on \([x_i-\gamma,x_i+\gamma]\), where it is defined by
\[h(x)=\frac{\alpha_i-\alpha_{i-1}}{2\gamma}[x-(x_i-\gamma)]+\alpha_{i-1}\]
(Note \(h\)~connects adjacent ``steps'' of~\(g\) using line segments defined over small subintervals.) Then \(h\)~is piecewise linear and continuous, and \(g=h\) except on a set of measure less than~\(n(\epsilon/n)=\epsilon\).

If \(m\le g\le M\), clearly \(m\le h\le M\).
\end{enumerate}

\noindent Finally, suppose \(f:[a,b]\to\Rex\) is measurable and finite~a.e. and let \(\epsilon>0\). By~(a), we may assume \(m\le f\le M\) except on a set~\(E_1\) with \(\mo E_1<\epsilon/3\). By~(b), there exists a simple function~\(\varphi\) with \(m\le\varphi\le M\) and \(\abs{f-\varphi}<\epsilon\) except on~\(E_1\). By~(c), there exists a step function~\(g\) with \(m\le g\le M\) and \(\varphi=g\) except on a set~\(E_2\) with \(\mo E_2<\epsilon/3\). Finally, by~(d) there exists a continuous function~\(h\) with \(m\le h\le M\) and \(g=h\) except on a set~\(E_3\) with \(\mo E_3<\epsilon/3\). Let \(E=E_1\union E_2\union E_3\), so \(\mo E<\epsilon\). Then \(\abs{f-g}<\epsilon\) and \(\abs{f-h}<\epsilon\) except on~\(E\).
\end{proof}
\begin{rmk}
This shows that measurable functions are ``almost'' step functions and ``almost'' continuous.
\end{rmk}

\begin{exer}[24]
If \(f:D\to\Rex\) is measurable and \(B\)~is a Borel set, then \(\inv{f}[B]\)~is measurable.
\end{exer}
\begin{proof}
Let \(\C\)~be the class of sets~\(X\) such that \(\inv{f}[X]\)~is measurable. We claim that \(\C\)~is a \(\sigma\)-algebra containing the open intervals, so that \(\C\)~contains the Borel sets by definition.

If \(X\in\C\), then \(\inv{f}[\comp{X}]=\comp{\inv{f}[X]}\) is measurable, so \(\comp{X}\in\C\). If \(X_n\in\C\), then \(\inv{f}[\bigunion X_n]=\bigunion\inv{f}[X_n]\) is measurable, so \(\bigunion X_n\in\C\). Therefore \(\C\)~is a \(\sigma\)-algebra. If \((\alpha,\beta)\)~is an interval, then
\[\inv{f}(\alpha,\beta)=\{\,\alpha<f<\beta\,\}=\{\,f>\alpha\,\}\sect\{\,f<\beta\,\}\]
is measurable, so \(\C\)~contains the open intervals.
\end{proof}

\begin{exer}[25]
If \(f:D\to\R\) is measurable and \(g:\R\to\R\) is continuous, then \(g\after f:D\to\R\) is measurable.
\end{exer}
\begin{proof}
For \(\alpha\in\R\),
\[\{\,g\after f>\alpha\,\}=\inv{(g\after f)}(\alpha,\infty)=\inv{f}[\inv{g}(\alpha,\infty)]\]
Note \(\inv{g}(\alpha,\infty)\)~is open, and hence Borel, since \(g\)~is continuous. Therefore \(\inv{f}[\inv{g}(\alpha,\infty)]\)~is measurable since \(f\)~is measurable (Exercise~24).
\end{proof}
\begin{rmk}
This shows that a continuous function of a measurable function is measurable.
\end{rmk}

\subsection*{Section~6}
\begin{rmk}
In the proof of Proposition~23, it is sufficient that \(\m\bigsect E_N=0\), which is true if \(f_n\to f\) a.e. This is just Proposition~24.
\end{rmk}

\begin{exer}[29]
Let \(E=(0,\infty)\), so \(E\)~is measurable with \(\m E=\infty\). Let \(f_n=\chr{(n,\infty)}\) and \(f=0\), so \(f_n\)~is measurable and \(f_n\to f\). Let \(\epsilon=\delta=1\). Then for all~\(N\),
\[\m\{\,\abs{f_N-f}\ge\epsilon\,\}=\m\{\,f_N=1\,\}=\m(N,\infty)=\infty>\delta\]
\end{exer}

\begin{exer}[30 (Egoroff)]
Let \(E\)~be measurable with \(\m E<\infty\). Let \(f_n:E\to\Rex\) be measurable and \(f:E\to\R\) with \(f_n\to f\) a.e. on~\(E\). Given \(\delta>0\), there exists \(A\subseteq E\) measurable with \(\m A<\delta\) such that \(f_n\to f\) uniformly on~\(E-A\).
\end{exer}
\begin{proof}
Let \(\epsilon_n=1/n\) and \(\delta_n=\delta/2^{n+1}\). For each~\(n\), there exists~\(N_n\) and \(A_n\subseteq E\) measurable with \(\m A_n<\delta_n\) such that \(\abs{f_m-f}<\epsilon_n\) for all \(m\ge N_n\) on~\(E-A_n\) (Proposition~24). Let \(A=\bigunion A_n\). Then \(A\)~is measurable and
\[\m A\le\sum\m A_n\le\sum\delta/2^{n+1}=\delta/2<\delta\]
Given \(\epsilon>0\), choose~\(n\) with \(\epsilon_n<\epsilon\) and set \(N=N_n\). Then for \(m\ge N\) and \(x\in E-A\subseteq E-A_n\),
\[\abs{f_m(x)-f(x)}<\epsilon_n<\epsilon\]
Therefore \(f_n\to f\) uniformly on \(E-A\).
\end{proof}
\begin{rmk}
This shows that a convergent sequence of measurable functions (on a set of finite measure) is ``almost'' uniformly convergent.
\end{rmk}

% References
\begin{thebibliography}{0}
\bibitem{royden} Royden, H.~L. \textit{Real Analysis}, 3rd~ed. Prentice Hall, 1988.
\end{thebibliography}
\end{document}
